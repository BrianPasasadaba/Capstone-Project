{% load static %}

<div class="modal fade" id="preview-incident-summary" tabindex="-1" aria-labelledby="modal-title" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <div class="mh-left">

                    <h3 class="modal-title" id="modal-title">INCIDENT SUMMARY</h3>
                    <div class="summary-option">
                        <div class="select-filter" id="period-filter">
                            <select class="form-select" aria-label="Default select example">
                                <option value="1" selected>Yearly</option>
                                <option value="2">Monthly</option>
                            </select>
                        </div>
                        <div class="select-filter" id="specific-filter">
                            <select class="form-select" aria-label="Default select example">
                                <option value="1" selected>January</option>
                                <option value="2">February</option>
                                <option value="3">March</option>
                                <option value="4">April</option>
                                <option value="5">May</option>
                                <option value="6">June</option>
                                <option value="7">July</option>
                                <option value="8">August</option>
                                <option value="9">September</option>
                                <option value="10">October</option>
                                <option value="11">November</option>
                                <option value="12">December</option>
                            </select>
                        </div>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="group-summary">
                    <div class="indiv-summary">
                        <div>Fire Detected Counts:</div>
                        <span>20</span>
                    </div>

                    <div class="indiv-summary" id="peakFireContainer">
                        <div>Peak Fire Month:</div>
                        <span id="peakFireValue"></span>
                    </div>
                    

                    <div class="indiv-summary" id="mostAffectedContainer">
                        <div>Most Affected Location:</div>
                        <span id="mostAffected"></span>
                    </div>

                    <div class="indiv-summary" id="totalCasualtyContainer">
                        <div>Total Casualties:</div>
                        <span id="totalCasualty"></span>
                    </div>


                    <div class="indiv-summary" id="estimatedDamageContainer"> 
                        <div>Estimated Damages:</div>
                        <span id="estimatedDamage"></span>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>


<script src="{% static 'js/incident_preview_filter.js' %}"></script>

<script>

fetch('/api/peak-report-summary/?year=2024') 
    .then(response => {
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        return response.json();
    })
    .then(data => {

        const peakFireSpan = document.getElementById('peakFireValue');
        peakFireSpan.textContent = data.peak_month;

        const mostAffectedSpan = document.getElementById('mostAffected');
        mostAffectedSpan.textContent = data.most_affected_location || 'No data';

        const totalCasualtySpan = document.getElementById('totalCasualty');
        totalCasualtySpan.textContent = data.total_casualties;

        const estimatedDamageSpan = document.getElementById('estimatedDamage');
        estimatedDamageSpan.textContent = data.total_estimated_damages || 'No data';
    })
    .catch(error => console.error('Error fetching peak fire data:', error));





</script>